# Copyright The OpenTelemetry Authors
# SPDX-License-Identifier: Apache-2.0
name: "Build and Publish"

on:
  release:
    types: [published]  # Trigger this workflow when a release is published

jobs:
  build_and_push_images:
    # Use a reusable workflow located in the same repository
    uses: ./.github/workflows/component-build-images.yml
    if: github.repository == 'open-telemetry/opentelemetry-demo'  # Ensure it only runs for a specific repository
    with:
      push: true  # Flag to indicate whether to push the images
      version: ${{ github.event.release.tag_name }}  # Use the release tag as the version for the image
    secrets: inherit  # Inherit all secrets from the parent workflow
